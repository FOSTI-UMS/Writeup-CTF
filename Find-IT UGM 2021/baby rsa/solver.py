'''
from Crypto.Util.number import getPrime, getRandomRange

FLAG = 'FindITCTF{REDACTED}'

p = getPrime(1024)
q = getPrime(1024)

N = p*q
e = 0x10001

N_masked = list(str(N))
for _ in range(6):
    N_masked[getRandomRange(0, len(N_masked))] = 'x'
N_masked = "".join(N_masked)

print(f"N_masked = {N_masked}")

C = [pow(ord(c), e, N)>>1 for c in FLAG]
print(f"C = {C}")
'''

def findN(N, e, c0, char):
    N = N.replace('x', '{}')
    for i in range(10):
        print('[+] I:', i)
        for j in range(10):
            print('[+] J:', j)
            for k in range(10):
                for l in range(10):
                    for m in range(10):
                        for n in range(10):
                            N2 = N.format(i,j,k,l,m,n)
                            for x in char:
                                p = pow(ord(x), e, int(N2))>>1
                                if  p == c0:
                                    return N2

flag = ''
char = ''.join(chr(i) for i in range(31337))
N = "21022850466621037769708677576925994323799557100753480004047244311247904448349530332497012095272352769059840683329533206682874110x289126845969366352627121095133697653792615564277853968085374458187497270011357018991524922740682560909276968423432230525022773410732626759045003404453844514854089059052168106105408307x70802712764976697277408322943223343255363381115432845840845941253305324016139244019454699910693785375999481543635730084790753124753680354721534315616158297852604043938719783x73397x46442242145088603060181358033531883703753x3374330449276881764159676919120402711238866891557x60413515481545371406947204366503"
C = [2430198054171813356468570419200271219449076576678977330702155384616422966536439984149652787904347786251991734760992063463550139087851526784224259823607886464568811278861060692629624417577836180853927037633292806215447779490673009596596933565173707500115086384952925964708116015644262374767227627807009902936513864177602227808922381342803670591707030422350287114960683371988515008787769116623902820270708142524650608287015791364491828342311872988229671275052238280448162923495868428668927634075544693571234378958228819990537566715349620258006624925299064003360157815357972581580801369171231235122802277830482900918219, 9566728321500734876625531603348534111799002643210231520525657276493085743668329623289193645151813776034477667907998918008475571386287892762567101290911260184007781551397323513129831131503530097626458639522687976097025298643673121243842805788507015686894994772660667527662588881314897993634976957117248916697283733849115527176433371164975315157546548533835617162074153643271677099131554857320590308555081770940563626749215685106607101883372679709741158526195214730376170238095825381504263766961510074222932132263337719728652529816032563557149599153233833837581337661540637765323387545072325898460279541349918485654224, 3169509546964349429386214666385064369514369193860276900187797209370988384355098230398887779481643557043458227238572301197613637122261612833612028422041331665716338360676832976019887427204375452316314498611081081498140911823429941447769263630995224684175085003434708440768781277445781151461828323798663950453605182824116270857601577647128757561638663627262411274377705184387531527793015495192700864491775202542819825636573596238634932129942900458951421895665136477565820588651955156144822132980105631424651098295411352279678660796223681125093444137220646130186690183147738084837875628494003850404020996380780513087978, 3879932989339520094562090999101080995905769216707287918947803034778209734005178125572948697395644066647550346027511187247105790700225384156276169225823922451442108168170451961195839777773624174063213448072999499971119782731161890371325674158438616675055011424425558445303524934023478295336997494030982361614609126744083970087571746978353241178402554884276572900679323403441923017729545881231945338973191470101386250905725525566156516326439741336205862685143764364290826910511611998603922923884923352839112683063997181208128434471491516110964116178337124262910773789683735513212247992113276635906694746476873021552457, 2476351644480911515700354236681677497257600367928059869432007941029672151270141478127150280468459858651753591173157958984659556013604111966055021376285016781946063371483986626015226407209114943266994479251385543899678931243303956788960151181948501412886941434956644491840869951573583189950006609861089439039670085156823075582597425970852852004282611665600285349778283501433906913629201378083434306818480583004947419503056479340691427844703181197552248792653055600923643910060977588150713836292511194992894855557152675451521866589019483980948127646167061242129751347002002335793401117648375094802352018834956871101274, 7880129004461734807433145083839369064154033601417597338985154137446198861378068365353665713111689910257167545538042673667324508413318084087152415598453317847169420986988610612885824580814506078719425652863758348987530330952509095212700744497577033901563719035549056922139511812193684149754473729342854266801774573333027346382377381878898766875091068506369597287649826257005821397762584876827727535035546336694267092426726556412159374624956836039118660053560110737228484443717240310767677155932718760181472371731275869090702649876982374092986226949797539798517500165103251987166591900092371455804433596302400984584111, 7545403351827456446990709223702156092315057743590090382464937623324919904436658539245610068872490899021733097378610668649108768250564919639451319588520996630373701865937781970810708144033936136434659322417950754067847645868631605798526379319984696365985553797784953688932420941971475683992905601962063613950737557401036671133497912874380824170497049822906528801839651297257424423305457272987625471747608357356797645431972491235998124135916252372142061525887621057376917999959733676763419654951361592552722096179687500782039105920851003175040512715908056376014502776286089630902084006539516180336513905668921277946097, 7880129004461734807433145083839369064154033601417597338985154137446198861378068365353665713111689910257167545538042673667324508413318084087152415598453317847169420986988610612885824580814506078719425652863758348987530330952509095212700744497577033901563719035549056922139511812193684149754473729342854266801774573333027346382377381878898766875091068506369597287649826257005821397762584876827727535035546336694267092426726556412159374624956836039118660053560110737228484443717240310767677155932718760181472371731275869090702649876982374092986226949797539798517500165103251987166591900092371455804433596302400984584111, 2430198054171813356468570419200271219449076576678977330702155384616422966536439984149652787904347786251991734760992063463550139087851526784224259823607886464568811278861060692629624417577836180853927037633292806215447779490673009596596933565173707500115086384952925964708116015644262374767227627807009902936513864177602227808922381342803670591707030422350287114960683371988515008787769116623902820270708142524650608287015791364491828342311872988229671275052238280448162923495868428668927634075544693571234378958228819990537566715349620258006624925299064003360157815357972581580801369171231235122802277830482900918219, 9851582267846852397141418763211987411122887663086874075183817338964600592757375010242500740464580327449579884879636687201824466353124856521700364460296080366483289279892010567252357283157589568886491409382007810431867262014662464742438351680101367536160356606668895428171724930136210284928724465804542650931365352254196174645214266579128896197581010509641320503269739867289926009777872701683170344305940308848768660480194900437008317216631833676326405542449386855492796892004517723035630886406908388453657294854680841221400877192515175597801502501247388426606023508481349559397725101264138134465882725228921324821783, 582891904944946068155890663925097000072987178075056871809156312346118459384839420881416165149982429629280967882076681695576512855338660898272789152088628496465971197494182848372500322675739685157463215123260953616683491028451451294054448669373987945680622467373993850156995542081657226804844296372971065710098138538629092991080623362375232396361304209312360561302252165439894447725145057335101754580937242845931163509209027383196100143863283949657106491167911347885303742491480236416207356382181535907500085615621357092038905613854956203594406327604503357880513259357694755101175690717029260043886816492325021344228, 2285168004007348233749526476127189055277001171384110323732705954003257003470689473733050665998274929292036439055039015448099150109544425705000169016697946266096335312310543223094742236967589262594410556361407569357717314970401478401635861151122510758647451500540405019519754116212208802223885278944206096511681841861542389793547814737502683256524526885019202574294893289324119283874124244592566289521435333201316190993216431284341223732606752623314679195060928433899921998733906966866463726001030574309936463694479940492633720359441665386432242809985472426787308859179362611448453577578713917034705851570763929502247, 5733805369174302174247741405625398024058069361678543051844663734874433295976927742004678991609278810855437861697260253706414884820045538525984267079730433970905801236233092407560470155906295444536815215885079899751752276657969511269250784995949991367246664567215907808612740127425280281096378448352736966615324435193403390358108157491375454516773462470634518114332729074923470571798795964122515658773178198616084746028198813395481921767070020955202293106636024498176965828397700218956618784599698716269349700964477108802490913863992443069347149194748520733916058327917015751732423607538812926118035789450000283572140, 1677875884156382577686617849645839435911554855710625726717010948595357371787637161795568310484503366646323367011765907143978177045089613394673933153696454370965827138163721685745285129250789284756570990508064460176836082294956387056251348469651359675978003830091450044232647752804939404373900496413518889432225408616930351704936357749783772135001023353441582030379944325223686942745001526958103467950268298377806533831492617963455299055354649667008317553835791278226389524103808011769664365229171706630036071306621484640439393873972826052792946521792827361499692377956533121338956119435955084472050281161955131447969, 4304125323925074225660463933648231324836043238568804641928556143815677117060403689027903877265749849293884612703871770505753876621095021120113521835453862908212048059418785831793365771952302454148430868509644803715093307733590569249720687414130210642691459954417670579255832988518748254067378171850772627073680196184149183339820890404985309542088487865691610769313685242564379865574109280130288536633371897050379258117685377991243685256740493612213821641836803233053598249416193578366354050904642404002994940758945509728016834864335459644488964052369184944016459217756872355218184853736416194575071302376699407015158, 6940551919227504745667879691524850798496190137651926980082842463534779123309044109564330103296952205616505545161431885992400245099890998099131134913103101943704726100502006254852072338429350724813975971729484781551461705558983647943840758683661098912488428103917050517956165884995552451214885041044165784634943751306025982397907911316553359139793924856469695708196475622416526510401023493777503509392922985266458975359390303354877691046340666211354825307630541610118163764312222701889033861451242072738968532305434022667110718403678287345367170175594662814706778694843213875377265082817623278019222476475161150297881, 4406774949480307260470476027419597941551482396767880302071139002391110898183940450213158474028777406695634954415201373465039674957525411628635776013698926180721327867217205089904023802185799365786279865092300695212956462822635630597838209822157372030584121617849607393698674354128938913664489860833010997169308908566695082921310663276969762137454275776349811803526301866692202520123621769501910931230111588048874453874506220867919990526481615176593835154794775595044631299956883835787643787803066022364118921164612413495290582408277693026544701914755400556704182877850853943422345544756698108301140385225332674121838, 4304125323925074225660463933648231324836043238568804641928556143815677117060403689027903877265749849293884612703871770505753876621095021120113521835453862908212048059418785831793365771952302454148430868509644803715093307733590569249720687414130210642691459954417670579255832988518748254067378171850772627073680196184149183339820890404985309542088487865691610769313685242564379865574109280130288536633371897050379258117685377991243685256740493612213821641836803233053598249416193578366354050904642404002994940758945509728016834864335459644488964052369184944016459217756872355218184853736416194575071302376699407015158, 5957711165266396257751023571821999945793084760571482665987263990235811357083195895418522541654896576185750884772694122871613714189453678433169243629425791790049192579279748855551694182100640258163974106239157353492995306493192712745827160927473793735920756717197278107516205448120198291258217938412074358125605515514615803003289281465274991136243034005080230089713421046459384296711719246436168352323309413914513496859351634516369977637444040522440208324888508782770387496896972069904767513789561391921184704598899149170489225060825733103592453599996974416633730878523892918336471830491750232521932008836034651299131, 5204727378331853092024463438895299744059696164542846521555162835432554034871927034642223222232208420324849410449208043177362952686043504365175544526162056936422842702109408045465104127285842024921137463940851598408308103853277332754248521677167947985132930203088659253760690009874118802723747978648307594395662719408538149937195684556332714776841950685243388212514895968639380126115433734621728408660869777270519801105713153507150716853893272817997596182967652442695085212077551085644948393268234415077186332388571108084606497857568388320451712700562943498732816879974676184558093416308231264442251427327259829152777, 4630357776268037723182267379934522884317669523156926724270108023825742813749670341673806875961313163698180709037235909430943837214294952170480978531385926672343683313125114269483252589511991939791072381272252600386116582837251906213348228962290992170935681806255044246102006801140755743129063589992581265970470343867014636443978801536799819837843640472285718005445744365427743550575645279429734735073204046470609772578407945752928979557047330382788220525179410530192465676725788673343599483826089975445847099200284004954810492786471701664370159173523106795085471794288875610683427008488571994739706772294814472454253, 2285168004007348233749526476127189055277001171384110323732705954003257003470689473733050665998274929292036439055039015448099150109544425705000169016697946266096335312310543223094742236967589262594410556361407569357717314970401478401635861151122510758647451500540405019519754116212208802223885278944206096511681841861542389793547814737502683256524526885019202574294893289324119283874124244592566289521435333201316190993216431284341223732606752623314679195060928433899921998733906966866463726001030574309936463694479940492633720359441665386432242809985472426787308859179362611448453577578713917034705851570763929502247, 1530952458254082476443370429302708541355385921989018205157514790182744645682520817140062853047212061195349215828120948247721304887563687519000111411463247082321239268770020213492198092086485236723858648993195545384980805793941187155177008833389925975458367946462280835157888586773404199528723864374346110937012069278659417781215836511750336680233505296944783372437175852011855140617704272670409380132913940186476672093805631725383091411089365882712716432518504458368455718785029060433343478413497200609769528001629456282296071041203578826247800129927248394810865182359580333611181877667370542216310308360081664201432, 4406774949480307260470476027419597941551482396767880302071139002391110898183940450213158474028777406695634954415201373465039674957525411628635776013698926180721327867217205089904023802185799365786279865092300695212956462822635630597838209822157372030584121617849607393698674354128938913664489860833010997169308908566695082921310663276969762137454275776349811803526301866692202520123621769501910931230111588048874453874506220867919990526481615176593835154794775595044631299956883835787643787803066022364118921164612413495290582408277693026544701914755400556704182877850853943422345544756698108301140385225332674121838, 5204727378331853092024463438895299744059696164542846521555162835432554034871927034642223222232208420324849410449208043177362952686043504365175544526162056936422842702109408045465104127285842024921137463940851598408308103853277332754248521677167947985132930203088659253760690009874118802723747978648307594395662719408538149937195684556332714776841950685243388212514895968639380126115433734621728408660869777270519801105713153507150716853893272817997596182967652442695085212077551085644948393268234415077186332388571108084606497857568388320451712700562943498732816879974676184558093416308231264442251427327259829152777, 3879932989339520094562090999101080995905769216707287918947803034778209734005178125572948697395644066647550346027511187247105790700225384156276169225823922451442108168170451961195839777773624174063213448072999499971119782731161890371325674158438616675055011424425558445303524934023478295336997494030982361614609126744083970087571746978353241178402554884276572900679323403441923017729545881231945338973191470101386250905725525566156516326439741336205862685143764364290826910511611998603922923884923352839112683063997181208128434471491516110964116178337124262910773789683735513212247992113276635906694746476873021552457, 4118954427171798336165304506295279880631046102991442704148166764200494607080301668391794440218558936365422006442372957765633986431921878646458558388840798405455432262029684907555917960564708823731319594959850783938273338536831608508043898390766582937140119627309803424772948632555946909195762541962485399536025754942304475488440392044373376889178137259855664185803547658946115435304573197982859920938410078271774694433683108432237411716853222612380361227260849849920455348770727374105382980058431327391502673680456828927292673386434732120742473162534907653740428647987712625266177417523867402248411058075875471943551, 1677875884156382577686617849645839435911554855710625726717010948595357371787637161795568310484503366646323367011765907143978177045089613394673933153696454370965827138163721685745285129250789284756570990508064460176836082294956387056251348469651359675978003830091450044232647752804939404373900496413518889432225408616930351704936357749783772135001023353441582030379944325223686942745001526958103467950268298377806533831492617963455299055354649667008317553835791278226389524103808011769664365229171706630036071306621484640439393873972826052792946521792827361499692377956533121338956119435955084472050281161955131447969, 4630357776268037723182267379934522884317669523156926724270108023825742813749670341673806875961313163698180709037235909430943837214294952170480978531385926672343683313125114269483252589511991939791072381272252600386116582837251906213348228962290992170935681806255044246102006801140755743129063589992581265970470343867014636443978801536799819837843640472285718005445744365427743550575645279429734735073204046470609772578407945752928979557047330382788220525179410530192465676725788673343599483826089975445847099200284004954810492786471701664370159173523106795085471794288875610683427008488571994739706772294814472454253, 5204727378331853092024463438895299744059696164542846521555162835432554034871927034642223222232208420324849410449208043177362952686043504365175544526162056936422842702109408045465104127285842024921137463940851598408308103853277332754248521677167947985132930203088659253760690009874118802723747978648307594395662719408538149937195684556332714776841950685243388212514895968639380126115433734621728408660869777270519801105713153507150716853893272817997596182967652442695085212077551085644948393268234415077186332388571108084606497857568388320451712700562943498732816879974676184558093416308231264442251427327259829152777, 3169509546964349429386214666385064369514369193860276900187797209370988384355098230398887779481643557043458227238572301197613637122261612833612028422041331665716338360676832976019887427204375452316314498611081081498140911823429941447769263630995224684175085003434708440768781277445781151461828323798663950453605182824116270857601577647128757561638663627262411274377705184387531527793015495192700864491775202542819825636573596238634932129942900458951421895665136477565820588651955156144822132980105631424651098295411352279678660796223681125093444137220646130186690183147738084837875628494003850404020996380780513087978, 148624446456744850014951568852511563780546668141075118847343094045245691491870110080492690785690499256467908013917937900225117806185236271720389393206962050819342035497123370727754407918049715832960196570331946807100376195224265630955544944038743539527155159628728709368828098314714074926249788969405282127506407668448738917363117260935320112742320793127292801600242879986203805605025031454033078051550555223006520166129152148625340234046197102770285013586229317034324117762301987507727519582323936506791801880549302483313736011162083236433133570465237078759323747353313570606410210032671052472128478502769231743320, 8475789040237622229870745167154332146239159120756090904069743135894653011396275329384261014722240127474145052394144608107233623848207143058405139600474203157797098964215457021852506902626150336720372388700247065011660293364793479462801172262721103191235824270201277105342497379713835501890194711226975870196550405883676032127752314806067873872247001990239191561236206524660566929372152373061377655522576068251160202397271516278479452891563877989214235902807030830225433334016537129159288866227656818199685518988327189225828665346241498053551685341206015673003768144716201404201192089104833390697075393518247731503554, 2430198054171813356468570419200271219449076576678977330702155384616422966536439984149652787904347786251991734760992063463550139087851526784224259823607886464568811278861060692629624417577836180853927037633292806215447779490673009596596933565173707500115086384952925964708116015644262374767227627807009902936513864177602227808922381342803670591707030422350287114960683371988515008787769116623902820270708142524650608287015791364491828342311872988229671275052238280448162923495868428668927634075544693571234378958228819990537566715349620258006624925299064003360157815357972581580801369171231235122802277830482900918219, 1144785054039760191623952003523602646244313727448442889119378446338349412899289824304111654926966230059741923222795421854208800300847171957497188722560465162270878353915189722962567804100351332917972915532099107672898100974101245135028017747281178676793749603446183139455300433217042551726992262330364296347119969007648240326072056864342058480184711810102411888626352758232684978387823849956095792235894689075396568667776000003858478406124786064748826222384614506562479411151901146527136313372762316747383696943124574408979281769199974067394072158045116268189970569156249660680680211055856565813659561243691192078154]
e = 0x10001
#N = findN(N, e, C[0], char)
N = 21022850466621037769708677576925994323799557100753480004047244311247904448349530332497012095272352769059840683329533206682874110128912684596936635262712109513369765379261556427785396808537445818749727001135701899152492274068256090927696842343223052502277341073262675904500340445384451485408905905216810610540830737080271276497669727740832294322334325536338111543284584084594125330532401613924401945469991069378537599948154363573008479075312475368035472153431561615829785260404393871978337339784644224214508860306018135803353188370375363374330449276881764159676919120402711238866891557160413515481545371406947204366503

for i in C:
    for j in char:
        if pow(ord(j), e, N)>>1 == i:
            flag += j
            break
print(flag)

